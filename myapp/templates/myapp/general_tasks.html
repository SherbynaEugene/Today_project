{% load static %}
<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>ToDaY | –ó–∞–≥–∞–ª—å–Ω—ñ —Å–ø—Ä–∞–≤–∏</title>
    <link href="https://fonts.googleapis.com/css2?family=Unbounded:wght@700;900&family=Manrope:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'myapp/css/menu.css' %}"> <style>
        .general-container {
            flex: 1;
            padding: 40px;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* –í–∞–∂–ª–∏–≤–æ: —â–æ–± –∫–∞—Ä—Ç–∫–∞ –Ω–µ —Ä–æ–∑—Ç—è–≥—É–≤–∞–ª–∞—Å—è –Ω–∞ –≤–µ—Å—å –µ–∫—Ä–∞–Ω –ø—Ä–∏–º—É—Å–æ–≤–æ */
            min-height: 100vh;
            overflow-y: auto;
        }

        .white-card {
            background: white;
            border-radius: 40px;
            width: 100%;
            max-width: 900px;
            padding: 50px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.02);
            height: auto;       /* –ö–∞—Ä—Ç–∫–∞ –ø—ñ–¥–ª–∞—à—Ç–æ–≤—É—î—Ç—å—Å—è –ø—ñ–¥ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ø—Ä–∞–≤ */
            min-height: min-content;
            display: block;      /* –ü–µ—Ä–µ–∫–æ–Ω—É—î–º–æ—Å—å, —â–æ —Ü–µ –±–ª–æ—á–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç */
            margin-bottom: 50px;
        }

        .page-title {
            font-family: 'Unbounded', sans-serif;
            font-size: 28px;
            font-weight: 900;
            color: var(--green-dark);
            margin-bottom: 40px;
            text-transform: uppercase;
        }

        .section-label {
            font-size: 11px;
            font-weight: 800;
            color: #ccc;
            letter-spacing: 1px;
            margin: 30px 0 15px 10px;
            text-transform: uppercase;
        }

        .task-item {
            background: white;
            border: 2px solid #f0f0f0;
            border-radius: 20px;
            padding: 20px 25px;
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 12px;
            transition: 0.2s;
        }

        .task-item:hover { border-color: #e0e0e0; transform: translateY(-2px); }

        .circle-check {
            width: 24px;
            height: 24px;
            border: 2px solid #ced4da;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            cursor: pointer;
            text-decoration: none;
        }

        .task-item.done { opacity: 0.5; border-style: dashed; }
        .circle-check.done { background: #e0f0e0; border-color: #2d5a2d; color: #2d5a2d; }

        .task-content { flex: 1; }
        .task-name { font-weight: 700; font-size: 16px; color: var(--text-dark); margin-bottom: 4px; }

        .task-meta-row { display: flex; align-items: center; gap: 15px; font-size: 12px; }
        .time-info { color: #aaa; font-weight: 600; display: flex; align-items: center; gap: 5px; }

        .cat-tag {
            background: #f0f7ff;
            color: #007bff;
            padding: 2px 8px;
            border-radius: 6px;
            font-weight: 800;
            font-size: 10px;
            text-transform: uppercase;
        }

        /* –°—Ç–∏–ª—ñ –¥–ª—è –±–ª–∏—Å–∫–∞–≤–∫–∏ –ø–µ—Ä–µ–Ω–æ—Å—É */
        .lightning-btn { color: #888; transition: 0.2s; }
        .lightning-btn:hover { color: var(--purple); }

        /* –ü—Ä–∏–±–∏—Ä–∞—î–º–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ —Å—Ç–∏–ª—ñ –∫–Ω–æ–ø–∫–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞ */
        .accordion-header {
            width: 100%;
            background: none;
            border: none;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 10px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
            margin-top: 20px;
        }

        .label-text {
            font-size: 11px;
            font-weight: 800;
            color: #ccc;
            letter-spacing: 1px;
        }

        .arrow {
            color: #ccc;
            font-size: 18px;
            transition: transform 0.3s;
        }

        /* –ö–æ–Ω—Ç–µ–Ω—Ç, —è–∫–∏–π –∑–≥–æ—Ä—Ç–∞—î—Ç—å—Å—è */
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out, opacity 0.3s;
            opacity: 0;
        }

        /* –ö–ª–∞—Å –¥–ª—è —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–æ–≥–æ —Å—Ç–∞–Ω—É */
        .accordion-content.open {
            max-height: 2000px; /* –î–æ—Å—Ç–∞—Ç–Ω—è –≤–∏—Å–æ—Ç–∞ –¥–ª—è —Å–ø–∏—Å–∫—É */
            opacity: 1;
            overflow-y: auto; /* –î–æ–∑–≤–æ–ª—è—î –≥–æ—Ä—Ç–∞—Ç–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ, —è–∫—â–æ –¥—É–∂–µ –±–∞–≥–∞—Ç–æ —Å–ø—Ä–∞–≤ */
        }

        /* –ü–æ–≤–æ—Ä–æ—Ç —Å—Ç—Ä—ñ–ª–æ—á–∫–∏ */
        .accordion-header.active .arrow {
            transform: rotate(0deg);
            color: var(--green-dark);
        }
        .accordion-header .arrow {
            transform: rotate(-90deg);
        }

        .empty-msg { color: #ccc; padding: 20px; font-size: 14px; }

        .lightning-btn {
    font-size: 13px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.2s;
}

.lightning-btn.not-today {
    color: #a855f7; /* —Ñ—ñ–æ–ª–µ—Ç–æ–≤–∏–π */
}

.lightning-btn.not-today:hover {
    color: #7e22ce; /* —Ç–µ–º–Ω—ñ—à–∏–π —Ñ—ñ–æ–ª–µ—Ç–æ–≤–∏–π –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–Ω—ñ */
    transform: translateY(-2px);
}

.lightning-btn.today {
    color: #22c55e; /* –∑–µ–ª–µ–Ω–∏–π –¥–ª—è —É–∂–µ Today */
}

.lightning-btn.today:hover {
    transform: translateY(-2px);
}
    </style>
</head>
<body>

    <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ SIDEBAR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <aside class="sidebar">
    <div class="logo">
        <div class="logo-icon">T</div>
        <div class="logo-text">ToDaY</div>
    </div>

    <a href="{% url 'tasks:today_tasks' %}" class="nav-label">
        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
        <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z"/>
        </svg>
        –°–¨–û–ì–û–î–ù–Ü
        <span class="nav-dot"></span>
    </a>

    <a href="{% url 'tasks:task_list' %}" class="nav-label chosen">
        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
        </svg>
        –£–°–Ü –°–ü–†–ê–í–ò
        <span class="nav-dot"></span>
    </a>

    <a href="{% url 'myapp:calendar' %}" class="nav-label" style="text-decoration:none;">
        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
        <line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/>
        <line x1="3" y1="10" x2="21" y2="10"/>
        </svg>
        –ö–ê–õ–ï–ù–î–ê–†
        <span class="nav-dot"></span>
    </a>

    <a href="{% url 'myapp:interesting' %}" class="nav-label">
        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
        </svg>
        –¶–Ü–ö–ê–í–ï–ù–¨–ö–û
        <span class="nav-dot"></span>
    </a>

    <a href="{% url 'rating:my_rating' %}" class="nav-label" >
    <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path d="M8 6h13M8 12h13M8 18h13M3 6h.01M3 12h.01M3 18h.01"/>
    </svg>
    –†–ï–ô–¢–ò–ù–ì
    <span class="nav-dot"></span>
    </a>

    <div class="sidebar-spacer"></div>

    <a href="{% url 'myapp:profile' %}" class="profile-card" style="text-decoration: none; color: inherit; display: flex;">
        <div class="profile-avatar">
        <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/>
            <circle cx="12" cy="7" r="4"/>
        </svg>
        </div>
        <div class="profile-info">
        <div class="profile-label">–ü—Ä–æ—Ñ—ñ–ª—å</div>
        <div class="profile-name">{{ request.user.username }}</div>
        </div>
        <div class="coins">
        <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24" style="color:var(--orange)">
            <circle cx="12" cy="12" r="10"/>
        </svg>
        {{ request.user.coins|default:0 }}
        </div>
    </a>
    </aside>


    <main class="general-container">
        <div class="white-card">
            <h1 class="page-title">–£–°–Ü –°–ü–†–ê–í–ò</h1>

            <div class="accordion-section">
                <button class="accordion-header active" onclick="toggleAccordion('incomplete-list', this)">
                    <span class="label-text">–ù–ï–í–ò–ö–û–ù–ê–ù–Ü</span>
                    <span class="arrow">‚ñæ</span>
                </button>
                <div id="incomplete-list" class="accordion-content open">
                    {% for task in incomplete_tasks %}
                    <div class="task-item">
                        <a href="{% url 'tasks:complete_task' task.id %}" class="circle-check"></a>
                        <div class="task-content">
                            <div class="task-name">{{ task.title }}</div>
                            <div class="task-meta-row">
                                <span class="time-info">üïí {{ task.estimated_hours }} –≥–æ–¥</span>
                                <span class="cat-tag">{{ task.category.name|upper|default:"" }}</span>
                            </div>
                        </div>
                        {% if task.is_for_today %}
                            <!-- –ó–∞–≤–¥–∞–Ω–Ω—è –≤–∂–µ –Ω–∞ Today -->
                            <a href="{% url 'tasks:move_to_today' task.id %}" class="lightning-btn today" title="–í–∂–µ –Ω–∞ —Å—å–æ–≥–æ–¥–Ω—ñ">‚úî</a>
                        {% else %}
                            <!-- –©–µ –Ω–µ –¥–æ–¥–∞–Ω–æ -->
                            <a href="{% url 'tasks:move_to_today' task.id %}" class="lightning-btn not-today" title="–î–æ–¥–∞—Ç–∏ –Ω–∞ —Å—å–æ–≥–æ–¥–Ω—ñ">‚ûï</a>
                        {% endif %}
                        <a href="{% url 'tasks:delete_task' task.id %}"
                            onclick="return confirm('–í–∏–¥–∞–ª–∏—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è?')"
                            style="color:#ccc; font-size:16px; text-decoration:none; margin-left:4px;"
                            title="–í–∏–¥–∞–ª–∏—Ç–∏">‚úï</a>
                    </div>
                    {% empty %}
                        <p class="empty-msg">–°–ø–∏—Å–æ–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π</p>
                    {% endfor %}
                </div>
            </div>

            <div class="accordion-section">
                <button class="accordion-header" onclick="toggleAccordion('completed-list', this)">
                    <span class="label-text">–í–ò–ö–û–ù–ê–ù–Ü</span>
                    <span class="arrow">‚ñ∏</span>
                </button>
                <div id="completed-list" class="accordion-content">
                    {% for task in completed_tasks %}
                    <div class="task-item done">
                        <div class="circle-check done">‚úì</div>
                        <div class="task-content">
                            <div class="task-name" style="text-decoration: line-through;">{{ task.title }}</div>
                            <div class="task-meta-row">
                                <span class="time-info">üïí {{ task.estimated_hours }} –≥–æ–¥</span>
                                <span class="cat-tag" style="background:#eee; color:#999;">{{ task.category.name|upper }}</span>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        </div>
    </main>
    <script>
    function toggleAccordion(id, btn) {
        const content = document.getElementById(id);

        // –ü–µ—Ä–µ–º–∏–∫–∞—î–º–æ –∫–ª–∞—Å open
        content.classList.toggle('open');

        // –ü–µ—Ä–µ–º–∏–∫–∞—î–º–æ –∞–∫—Ç–∏–≤–Ω–∏–π —Å—Ç–∞–Ω –∫–Ω–æ–ø–∫–∏ –¥–ª—è –ø–æ–≤–æ—Ä–æ—Ç—É —Å—Ç—Ä—ñ–ª–∫–∏
        btn.classList.toggle('active');

        // –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç—Ä—ñ–ª–æ—á–∫—É (—Ç–µ–∫—Å—Ç–æ–º –∞–±–æ —Å–∏–º–≤–æ–ª–æ–º)
        const arrow = btn.querySelector('.arrow');
        if (content.classList.contains('open')) {
            arrow.innerHTML = '‚ñæ';
        } else {
            arrow.innerHTML = '‚ñ∏';
        }
    }</script>
</body>
</html>
